<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/shipitjs/shipit-deploy">shipit-deploy (v2.4.0)</a>
</h1>
<h4>Set of deployment tasks for Shipit based on git and rsync commands. </h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.shipit-deploy">module shipit-deploy</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.shipit-deploy.shipit-deploy">
            function <span class="apidocSignatureSpan"></span>shipit-deploy
            <span class="apidocSignatureSpan">(shipit)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">shipit-deploy.</span>shipit</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.shipit-deploy.shipit">module shipit-deploy.shipit</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.shipit-deploy.shipit.getCurrentReleaseDirname">
            function <span class="apidocSignatureSpan">shipit-deploy.shipit.</span>getCurrentReleaseDirname
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.shipit-deploy.shipit.getPendingCommits">
            function <span class="apidocSignatureSpan">shipit-deploy.shipit.</span>getPendingCommits
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.shipit-deploy.shipit.getReleases">
            function <span class="apidocSignatureSpan">shipit-deploy.shipit.</span>getReleases
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.shipit-deploy.shipit.getRevision">
            function <span class="apidocSignatureSpan">shipit-deploy.shipit.</span>getRevision
            <span class="apidocSignatureSpan">(releaseDir)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.shipit-deploy" id="apidoc.module.shipit-deploy">module shipit-deploy</a></h1>


    <h2>
        <a href="#apidoc.element.shipit-deploy.shipit-deploy" id="apidoc.element.shipit-deploy.shipit-deploy">
        function <span class="apidocSignatureSpan"></span>shipit-deploy
        <span class="apidocSignatureSpan">(shipit)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">shipit-deploy = function (shipit) {
  require('./tasks/deploy')(shipit);
  require('./tasks/rollback')(shipit);
  require('./tasks/pending')(shipit);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.shipit-deploy.shipit" id="apidoc.module.shipit-deploy.shipit">module shipit-deploy.shipit</a></h1>


    <h2>
        <a href="#apidoc.element.shipit-deploy.shipit.getCurrentReleaseDirname" id="apidoc.element.shipit-deploy.shipit.getCurrentReleaseDirname">
        function <span class="apidocSignatureSpan">shipit-deploy.shipit.</span>getCurrentReleaseDirname
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCurrentReleaseDirname = function () {
  var shipit = this;

  return shipit.remote(util.format('if [ -h %s ]; then readlink %s; fi', shipit.currentPath, shipit.currentPath))
  .then(function(results) {
    results = results || [];
    var releaseDirnames = results.map(computeReleaseDirname);

    if (!equalValues(releaseDirnames)) {
      throw new Error('Remote servers are not synced.');
    }

    if (!releaseDirnames[0]) {
      shipit.log('No current release found.');
      return null;
    }

    return releaseDirnames[0];
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return response[0].stdout.trim();
});
};

Shipit.getPendingCommits = function() {
var shipit = this;

return shipit.<span class="apidocCodeKeywordSpan">getCurrentReleaseDirname</span>()
.then(function(currentReleaseDirname) {
  if (!currentReleaseDirname) {
    return null;
  }
  return shipit.getRevision(currentReleaseDirname)
  .then(function(deployedRevision) {
    if (!deployedRevision) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.shipit-deploy.shipit.getPendingCommits" id="apidoc.element.shipit-deploy.shipit.getPendingCommits">
        function <span class="apidocSignatureSpan">shipit-deploy.shipit.</span>getPendingCommits
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPendingCommits = function () {
  var shipit = this;

  return shipit.getCurrentReleaseDirname()
  .then(function(currentReleaseDirname) {
    if (!currentReleaseDirname) {
      return null;
    }
    return shipit.getRevision(currentReleaseDirname)
    .then(function(deployedRevision) {
      if (!deployedRevision) {
        return null;
      }

      // Get local remotes.
      return shipit.local('git remote', {cwd: shipit.config.workspace}).then(function(res) {
        var remotes = res &amp;&amp; res.stdout ? res.stdout.split(/\s/) : [];

        if (remotes.length &lt; 1) {
          return null;
        }

        // Compare against currently undeployed revision
        var compareRevision = remotes[0] + '/' + shipit.config.branch;

        // Print diff
        return shipit.local('git log --pretty=format:\"' + shipit.config.gitLogFormat + '\" ' + deployedRevision + '..' + compareRevision
, {cwd: shipit.config.workspace})
        .then(function(response) {
          response = response.stdout.trim();
          return response || null;
        });
      });
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.shipit-deploy.shipit.getReleases" id="apidoc.element.shipit-deploy.shipit.getReleases">
        function <span class="apidocSignatureSpan">shipit-deploy.shipit.</span>getReleases
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getReleases = function () {
  var shipit = this;

  return shipit.remote('ls -r1 ' + shipit.releasesPath)
  .then(function(results) {
    var releases = results.map(computeReleases);

    if (!equalValues(releases))
      throw new Error('Remote servers are not synced.');

    return releases[0];
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.shipit-deploy.shipit.getRevision" id="apidoc.element.shipit-deploy.shipit.getRevision">
        function <span class="apidocSignatureSpan">shipit-deploy.shipit.</span>getRevision
        <span class="apidocSignatureSpan">(releaseDir)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRevision = function (releaseDir) {
  var shipit = this;
  var file = path.join(shipit.releasesPath, releaseDir, 'REVISION');

  return shipit.remote('if [ -f ' + file + ' ]; then cat ' + file + ' 2&gt;/dev/null; fi;')
  .then(function(response) {
    return response[0].stdout.trim();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var shipit = this;

  return shipit.getCurrentReleaseDirname()
  .then(function(currentReleaseDirname) {
    if (!currentReleaseDirname) {
return null;
    }
    return shipit.<span class="apidocCodeKeywordSpan">getRevision</span>(currentReleaseDirname)
    .then(function(deployedRevision) {
if (!deployedRevision) {
  return null;
}

// Get local remotes.
return shipit.local('git remote', {cwd: shipit.config.workspace}).then(function(res) {
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>